function wdgInitSortable(e){e(".wd_gallery_mb").sortable()}function wdgInitPhotos(e){e(".wd_gallery_add").click(function(e){e.preventDefault(),media_upload()})}function wdgInitRemove(e){e(".wd_gallery_remove").unbind("click"),e(".wd_gallery_remove").click(function(t){t.preventDefault(),e(this).parent(".wd_gallery_photo").slideUp(300,function(){e(this).remove()})})}function media_upload(){var e;return e?void e.open():(e=wp.media.frames.tgm_media_frame=wp.media({className:"media-frame tgm-media-frame",frame:"select",multiple:!0,title:"Insert Photos",library:{type:"image"},button:{text:"Insert into Gallery"}}),e.on("select",function(){var t=e.state().get("selection").toJSON();console.log(t),jQuery.each(t,function(e,t){var l=newPhotoTemplate(t.id,t.title,t.caption,t.alt,t.url);jQuery(".wd_gallery_mb").append(l)}),wdgInitRemove(jQuery)}),void e.open())}function newPhotoTemplate(e,t,l,a,i){var o='<div class="wd_gallery_photo"> 	<div class="wd_gallery_img"><img src="'+i+'"></div>	<div class="wd_gallery_details">		<label for="wd_gallery_title_'+e+'">Title</label>		<input type="text" id="wd_gallery_title_'+e+'" name="wd_gallery_title[]" value="'+t+'">		<label for="wd_gallery_caption'+e+'">Caption</label>		<input type="text" id="wd_gallery_caption'+e+'" name="wd_gallery_caption[]" value="'+l+'">		<label for="wd_gallery_alt'+e+'">Alt Text</label>		<input type="text" id="wd_gallery_alt'+e+'" name="wd_gallery_alt[]" value="'+a+'">	</div>	<input type="hidden" name="wd_gallery_photo[]" value="'+e+'">	<a href="#" class="button wd_gallery_remove">Remove Photo</a></div>';return o}function wdGalleryInsertForm(e){e>0?window.send_to_editor("[wd_gallery ID="+e+"]"):window.send_to_editor("[wd_gallery]")}jQuery(document).ready(function(e){wdgInitSortable(e),wdgInitPhotos(e),wdgInitRemove(e)});